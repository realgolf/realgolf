#!/bin/sh
# This script runs before each commit.

# Debugging: Output message to terminal
echo "Running pre-commit hook..."

# Install dependencies only if needed
pnpm install --frozen-lockfile

# Run build command
if ! pnpm run build; then
  echo "Build failed. Aborting commit."
  exit 1
fi

# Run formatting checks and automatically fix issues
if ! pnpm run format; then
  echo "Formatting failed. Aborting commit."
  exit 1
fi

# Stage any formatting changes
git add .

# Run linting checks and automatically fix issues
if ! pnpm run lint; then
  echo "Linting failed. Aborting commit."
  exit 1
fi

# Stage any linting changes
git add .

# If all checks pass, allow the commit to proceed
echo "All checks passed. Proceeding with commit..."

# Allow the user to enter the commit message
# Note: This will not modify the commit message you've already entered
exit 0
